<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#0ff" />
  <title>The Four Basic Waveforms • Synthesis Lab</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b0f14;             /* deep space */
      --bg-2: #0e1524;            /* panel depth */
      --text: #e6f3ff;            /* primary text */
      --muted: #7da0c8;           /* secondary text */
      --neon-1: #00e5ff;          /* cyan */
      --neon-2: #8a2be2;          /* electric violet */
      --neon-3: #ff3b81;          /* magenta */
      --accent: #00ffd1;          /* mint */
      --card: rgba(255,255,255,0.06);
      --card-strong: rgba(255,255,255,0.12);
      --border: rgba(255,255,255,0.18);
      --shadow: 0 20px 60px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,0.04) inset;
      --radius: 18px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: "Space Grotesk", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 600px at 10% -10%, rgba(0,229,255,.2), transparent 60%),
                  radial-gradient(900px 500px at 110% 10%, rgba(138,43,226,.15), transparent 50%),
                  linear-gradient(180deg, #0a0f1a 0%, #071018 100%);
      overflow-x: hidden;
    }

    /* === Ambient hologrid === */
    .holo-grid {
      position: fixed; inset: 0; pointer-events: none; z-index: 0; opacity: .35;
      background-image: linear-gradient(to right, rgba(255,255,255,.06) 1px, transparent 1px),
                        linear-gradient(to bottom, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size: 24px 24px;
      mask: radial-gradient(80% 60% at 50% 40%, black 40%, transparent 100%);
    }

    /* animated gradient aurora */
    .aurora {
      position: fixed; inset: -20% -20% auto -20%; height: 70vh; z-index: 0; filter: blur(40px); opacity: .4;
      background: conic-gradient(from 0deg, var(--neon-1), var(--neon-2), var(--neon-3), var(--neon-1));
      animation: spin 24s linear infinite;
      transform-origin: 60% 40%;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .container {
      position: relative; z-index: 1;
      max-width: 1200px; margin: 64px auto; padding: 0 24px 120px;
    }

    header.site-header {
      display: grid; grid-template-columns: auto 1fr auto; align-items: center; gap: 20px;
      padding: 18px 22px; margin-bottom: 28px;
      border-radius: calc(var(--radius) + 6px);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      backdrop-filter: blur(10px) saturate(130%);
      -webkit-backdrop-filter: blur(10px) saturate(130%);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
    }

    .brand {
      display: flex; align-items: center; gap: 14px; letter-spacing: 0.04em;
    }
    .brand-badge {
      width: 42px; height: 42px; border-radius: 12px; position: relative;
      background: radial-gradient(circle at 30% 30%, var(--neon-1), transparent 60%),
                  radial-gradient(circle at 70% 70%, var(--neon-2), transparent 60%),
                  #0b1625;
      border: 1px solid var(--border); box-shadow: var(--shadow);
    }
    .brand h1 {
      margin: 0; font-size: clamp(20px, 3.2vw, 28px); font-weight: 700;
      background: linear-gradient(90deg, var(--text) 0%, var(--accent) 100%);
      -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
    }
    .subtitle { color: var(--muted); font-size: 14px; margin-top: 2px; }

    .actions { display: flex; align-items: center; gap: 12px; }
    .btn {
      --glow: var(--neon-1);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      border: 1px solid var(--border);
      color: var(--text); padding: 10px 14px; border-radius: 12px; cursor: pointer;
      font: 600 14px/1 "Space Grotesk", system-ui; letter-spacing: .04em;
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
      box-shadow: 0 0 0 0 rgba(0,0,0,0);
    }
    .btn:hover { transform: translateY(-1px); border-color: var(--glow); box-shadow: 0 0 28px 0 color-mix(in srgb, var(--glow) 26%, transparent); }
    .btn.primary { --glow: var(--accent); background: linear-gradient(180deg, rgba(0,255,209,.18), rgba(0,255,209,.06)); }

    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      border: 1px solid var(--border); border-radius: var(--radius);
      padding: clamp(18px, 2.8vw, 28px); margin: 18px 0 26px; box-shadow: var(--shadow);
    }

    .hero {
      display: grid; gap: 10px; margin: 18px 0 28px;
    }
    .hero h2 {
      margin: 0; font-size: clamp(28px, 5vw, 44px); font-weight: 700; line-height: 1.08;
      background: linear-gradient(90deg, var(--text), var(--neon-1) 55%, var(--neon-2));
      -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
      text-shadow: 0 0 0 transparent;
    }
    .hero p { margin: 6px 0 0; color: var(--muted); font-size: clamp(14px, 1.6vw, 18px); }

    /* Waveform section cards */
    .grid {
      display: grid; gap: 20px; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }

    .wave-card { position: relative; overflow: clip; }
    .wave-card::after {
      content: ""; position: absolute; inset: -1px; border-radius: calc(var(--radius) + 2px);
      background: linear-gradient(120deg, color-mix(in srgb, var(--neon-1) 65%, transparent), transparent 35%),
                  linear-gradient(300deg, color-mix(in srgb, var(--neon-2) 55%, transparent), transparent 35%);
      filter: blur(18px); opacity: .25; z-index: -1;
    }

    .wave-title { display: flex; align-items: center; gap: 10px; margin: 0 0 10px; }
    .wave-title h3 { margin: 0; font-size: 20px; letter-spacing: .02em; }
    .tag { font: 700 11px/1 "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Consolas; color: var(--bg);
      background: linear-gradient(90deg, var(--neon-1), var(--neon-2)); padding: 6px 8px; border-radius: 999px; }

    .oscilloscope { position: relative; height: 180px; border-radius: 14px; overflow: hidden; border: 1px solid var(--border); background: #0e1524; box-shadow: inset 0 0 0 1px rgba(255,255,255,.02); }
    canvas.waveform-canvas { width: 100%; height: 100%; display: block; }
    .scanline { position: absolute; inset: 0; background: repeating-linear-gradient(180deg, rgba(255,255,255,.06) 0 1px, transparent 1px 3px); mix-blend-mode: overlay; pointer-events: none; }

    .controls { display: flex; flex-wrap: wrap; align-items: center; gap: 10px; margin-top: 12px; }
    .play-btn { --glow: var(--neon-3); }

    /* Characteristic / technique cards */
    .char-grid { display: grid; gap: 14px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    .char-card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 14px 16px; box-shadow: var(--shadow); }
    .char-card h4 { margin: 0 0 6px; font-size: 14px; color: var(--accent); letter-spacing: .04em; }
    .char-card p { margin: 0; color: var(--text); opacity: .9; font-size: 14px; }

    /* Interactive compare */
    .interactive { display: grid; gap: 14px; }
    .slider-row { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
    .label { color: var(--muted); font-size: 13px; }
    input[type="range"] { -webkit-appearance: none; appearance: none; height: 8px; width: min(380px, 70vw); background: linear-gradient(90deg, var(--neon-1), var(--neon-2)); border-radius: 999px; outline: none; border: 1px solid var(--border); }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 18px; height: 18px; border-radius: 50%; background: var(--text); border: 2px solid var(--bg); box-shadow: 0 0 0 6px color-mix(in srgb, var(--neon-1) 40%, transparent); cursor: pointer; }
    .value { font: 700 12px/1 "JetBrains Mono", ui-monospace; color: var(--neon-1); padding: 6px 10px; border: 1px solid var(--border); border-radius: 999px; background: var(--card-strong); }

    .mini-grid { display: grid; gap: 14px; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); }
    .mini { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 10px; cursor: pointer; transition: transform .15s ease, border-color .15s ease; box-shadow: var(--shadow); }
    .mini:hover { transform: translateY(-2px); border-color: var(--neon-1); }
    .mini-label { text-align: center; color: var(--muted); font-size: 12px; margin-top: 6px; }

    /* Technique section */
    .tech-grid { display: grid; gap: 14px; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .tech { background: linear-gradient(180deg, rgba(138,43,226,.16), rgba(0,229,255,.12)); border: 1px solid var(--border); border-radius: 16px; padding: 16px; box-shadow: var(--shadow); }
    .tech h4 { margin: 0 0 6px; color: var(--accent); letter-spacing: .04em; }
    .tech p { margin: 6px 0; color: var(--text); opacity: .92; }
    .mono { font-family: "JetBrains Mono", ui-monospace; font-size: 12px; color: var(--muted); }

    /* Tip boxes */
    .tips { display: grid; gap: 14px; }
    .tip { background: linear-gradient(180deg, rgba(0,255,209,.12), rgba(0,255,209,.05)); border: 1px dashed color-mix(in srgb, var(--accent) 60%, white); border-radius: 14px; padding: 14px 16px; }
    .tip h4 { margin: 0 0 6px; color: var(--accent); }

    /* Footer */
    footer { margin-top: 34px; color: var(--muted); font-size: 12px; display: flex; justify-content: space-between; gap: 10px; flex-wrap: wrap; }

    /* Responsive tweaks */
    @media (min-width: 900px) {
      .hero { grid-template-columns: 1.2fr .8fr; align-items: end; }
    }
  </style>
</head>
<body>
  <div class="holo-grid"></div>
  <div class="aurora" aria-hidden="true"></div>

  <div class="container">
    <header class="site-header">
      <div class="brand">
        <div class="brand-badge" aria-hidden="true"></div>
        <div>
          <h1>Synthesis Lab</h1>
          <div class="subtitle">Four Basic Waveforms • Modern Guide</div>
        </div>
      </div>
      <div></div>
      <div class="actions">
        <button class="btn" id="themeToggle" title="Toggle visual theme">Toggle Glow</button>
        <button class="btn primary" onclick="scrollToInteractive()">Try the Demo</button>
      </div>
    </header>

    <section class="panel hero">
      <div>
        <h2>The Four Basic Waveforms &amp; Synthesis</h2>
        <p>Master the building blocks of electronic sound. Explore <em>sine</em>, <em>square</em>, <em>sawtooth</em>, and <em>triangle</em> waves in a neon‑sleek lab with interactive scopes and an audio demo powered by the Web Audio API.</p>
      </div>
      <div class="panel" style="margin:0;">
        <div class="interactive">
          <div class="slider-row">
            <span class="label">Frequency</span>
            <input type="range" id="freqSlider" min="100" max="800" value="220" />
            <span class="value" id="freqDisplay">220 Hz</span>
          </div>
          <div class="mini-grid">
            <div class="mini" onclick="playWaveform('sine')" title="Play sine">
              <div class="oscilloscope"><canvas id="miniSine" class="waveform-canvas" width="300" height="120"></canvas><div class="scanline"></div></div>
              <div class="mini-label">Sine</div>
            </div>
            <div class="mini" onclick="playWaveform('square')" title="Play square">
              <div class="oscilloscope"><canvas id="miniSquare" class="waveform-canvas" width="300" height="120"></canvas><div class="scanline"></div></div>
              <div class="mini-label">Square</div>
            </div>
            <div class="mini" onclick="playWaveform('sawtooth')" title="Play sawtooth">
              <div class="oscilloscope"><canvas id="miniSaw" class="waveform-canvas" width="300" height="120"></canvas><div class="scanline"></div></div>
              <div class="mini-label">Sawtooth</div>
            </div>
            <div class="mini" onclick="playWaveform('triangle')" title="Play triangle">
              <div class="oscilloscope"><canvas id="miniTriangle" class="waveform-canvas" width="300" height="120"></canvas><div class="scanline"></div></div>
              <div class="mini-label">Triangle</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Wave cards -->
    <section class="grid">
      <!-- Sine -->
      <article class="panel wave-card">
        <div class="wave-title"><span class="tag">SINE</span><h3>Pure Foundation</h3></div>
        <div class="oscilloscope"><canvas id="sineCanvas" class="waveform-canvas" height="180"></canvas><div class="scanline"></div></div>
        <div class="controls">
          <button class="btn play-btn" onclick="playWaveform('sine')">Play</button>
        </div>
        <div class="char-grid">
          <div class="char-card"><h4>Sound</h4><p>Pure and smooth. Only the fundamental frequency.</p></div>
          <div class="char-card"><h4>Harmonics</h4><p>No overtones — the mathematical basis of all timbre.</p></div>
          <div class="char-card"><h4>Use</h4><p>Sub‑bass, FM carriers &amp; modulators, clean tone sources.</p></div>
          <div class="char-card"><h4>Tip</h4><p>Great as a sub‑oscillator one octave below.</p></div>
        </div>
      </article>

      <!-- Square -->
      <article class="panel wave-card">
        <div class="wave-title"><span class="tag">SQUARE</span><h3>Bold Fundamental</h3></div>
        <div class="oscilloscope"><canvas id="squareCanvas" class="waveform-canvas" height="180"></canvas><div class="scanline"></div></div>
        <div class="controls">
          <button class="btn play-btn" onclick="playWaveform('square')">Play</button>
        </div>
        <div class="char-grid">
          <div class="char-card"><h4>Sound</h4><p>Hollow/woody. Classic chiptune &amp; organ vibes.</p></div>
          <div class="char-card"><h4>Harmonics</h4><p>Odd harmonics only: 1st, 3rd, 5th… decreasing.</p></div>
          <div class="char-card"><h4>Use</h4><p>Leads, retro tones, PWM strings.</p></div>
          <div class="char-card"><h4>Tip</h4><p>Low‑pass it for evolving timbres.</p></div>
        </div>
      </article>

      <!-- Sawtooth -->
      <article class="panel wave-card">
        <div class="wave-title"><span class="tag">SAW</span><h3>Harmonic Powerhouse</h3></div>
        <div class="oscilloscope"><canvas id="sawCanvas" class="waveform-canvas" height="180"></canvas><div class="scanline"></div></div>
        <div class="controls">
          <button class="btn play-btn" onclick="playWaveform('sawtooth')">Play</button>
        </div>
        <div class="char-grid">
          <div class="char-card"><h4>Sound</h4><p>Bright &amp; buzzy. Richest harmonic content.</p></div>
          <div class="char-card"><h4>Harmonics</h4><p>All harmonics present with 1/n amplitude falloff.</p></div>
          <div class="char-card"><h4>Use</h4><p>Brass, strings, aggressive basses.</p></div>
          <div class="char-card"><h4>Tip</h4><p>Prime substrate for subtractive filtering.</p></div>
        </div>
      </article>

      <!-- Triangle -->
      <article class="panel wave-card">
        <div class="wave-title"><span class="tag">TRIANGLE</span><h3>Smooth Alternative</h3></div>
        <div class="oscilloscope"><canvas id="triangleCanvas" class="waveform-canvas" height="180"></canvas><div class="scanline"></div></div>
        <div class="controls">
          <button class="btn play-btn" onclick="playWaveform('triangle')">Play</button>
        </div>
        <div class="char-grid">
          <div class="char-card"><h4>Sound</h4><p>Softer than square, warmer than sine.</p></div>
          <div class="char-card"><h4>Harmonics</h4><p>Odd harmonics only, falling at 1/n².</p></div>
          <div class="char-card"><h4>Use</h4><p>Flute‑ish leads, mellow pads, gentle bass.</p></div>
          <div class="char-card"><h4>Tip</h4><p>Nice for subtle vibrato modulation sources.</p></div>
        </div>
      </article>
    </section>

    <!-- Techniques -->
    <section class="panel">
      <h3 style="margin-top:0">Synthesis Techniques</h3>
      <div class="tech-grid">
        <div class="tech"><h4>Subtractive</h4><p><span class="mono">Saw</span> &amp; <span class="mono">Square</span> → Filter → Envelope. Rich source → sculpt by removal.</p><p class="mono">Saw → LPF (resonance) → ADSR</p></div>
        <div class="tech"><h4>FM</h4><p><span class="mono">Sine</span> carrier + <span class="mono">Sine</span> modulator. Harmonics via frequency modulation ratios.</p><p class="mono">Carrier ⟂ Modulator (2:1) → Bell</p></div>
        <div class="tech"><h4>AM</h4><p>Amplitude modulation creates tremolo → sidebands at higher depths.</p><p class="mono">Triangle → AM(Saw)</p></div>
        <div class="tech"><h4>Additive</h4><p>Sum partials. Build spectra with stacked sines.</p><p class="mono">1f + 3f + 5f ≈ Square</p></div>
        <div class="tech"><h4>Pulse Width Mod</h4><p>Animate square duty cycle for lush motion.</p><p class="mono">Square (PWM) → Ensemble</p></div>
        <div class="tech"><h4>Ring Mod</h4><p>Multiply two sources for sum/diff frequencies → metallic/bell timbres.</p><p class="mono">Sine × Square</p></div>
      </div>
    </section>

    <footer>
      <div>Tip: Press <span class="mono">1/2/3/4</span> to play Sine/Square/Saw/Triangle.</div>
      <div id="status" class="mono">Audio: idle</div>
    </footer>
  </div>

  <script>
    // --- Audio engine ---
    let audioContext; let currentOsc = null; let currentGain = null; let currentFreq = 220;

    const statusEl = document.getElementById('status');
    const freqSlider = document.getElementById('freqSlider');
    const freqDisplay = document.getElementById('freqDisplay');

    function ensureAudio() {
      if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
      }
      return audioContext;
    }

    function setStatus(t){ statusEl.textContent = t; }

    function stopCurrent(time = 0.02){
      if (currentGain) {
        try { currentGain.gain.cancelScheduledValues(audioContext.currentTime); } catch(e){}
        currentGain.gain.setTargetAtTime(0.0001, audioContext.currentTime, time);
      }
      if (currentOsc) {
        try { currentOsc.stop(audioContext.currentTime + time*2); } catch(e){}
      }
    }

    function playWaveform(type){
      ensureAudio();
      stopCurrent();

      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();

      osc.type = type; osc.frequency.value = currentFreq;
      gain.gain.value = 0.0001;

      const filter = audioContext.createBiquadFilter();
      filter.type = 'lowpass'; filter.frequency.value = 16000; // transparent but future‑proof for effects

      osc.connect(filter); filter.connect(gain); gain.connect(audioContext.destination);

      const now = audioContext.currentTime;
      gain.gain.setValueAtTime(0.0001, now);
      gain.gain.exponentialRampToValueAtTime(0.18, now + 0.05);
      gain.gain.exponentialRampToValueAtTime(0.01, now + 1.8);

      osc.start(); osc.stop(now + 2.2);

      currentOsc = osc; currentGain = gain;
      setStatus(`Playing ${type} @ ${currentFreq}Hz`);
    }

    // --- UI ---
    function updateFrequency(val){
      currentFreq = parseInt(val, 10);
      freqDisplay.textContent = `${currentFreq} Hz`;
      drawAll();
    }

    freqSlider.addEventListener('input', (e)=> updateFrequency(e.target.value));

    // Keyboard shortcuts 1-4
    window.addEventListener('keydown', (e)=>{
      if(['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return;
      const map = { '1':'sine', '2':'square', '3':'sawtooth', '4':'triangle' };
      if(map[e.key]) { playWaveform(map[e.key]); }
    });

    // Theme toggle – cycles glow intensity by adjusting CSS vars slightly
    document.getElementById('themeToggle').addEventListener('click', ()=>{
      const root = document.documentElement;
      const cur = getComputedStyle(root).getPropertyValue('--neon-1').trim();
      root.style.setProperty('--neon-1', cur === '#00e5ff' ? '#00ffd1' : '#00e5ff');
      root.style.setProperty('--neon-2', cur === '#00e5ff' ? '#1a73ff' : '#8a2be2');
    });

    function scrollToInteractive(){
      document.querySelector('.hero .interactive').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // --- Drawing ---
    function drawWave(canvasId, type, cycles = 2){
      const canvas = document.getElementById(canvasId); if(!canvas) return;
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * dpr; canvas.height = rect.height * dpr;
      const ctx = canvas.getContext('2d'); ctx.scale(dpr, dpr);

      const w = rect.width, h = rect.height; const cx = h/2; const amp = h * 0.38;

      // background grid lines
      ctx.clearRect(0,0,w,h);
      ctx.fillStyle = '#0e1524'; ctx.fillRect(0,0,w,h);
      ctx.strokeStyle = 'rgba(255,255,255,.08)'; ctx.lineWidth = 1;
      ctx.beginPath(); ctx.moveTo(0, cx); ctx.lineTo(w, cx); ctx.stroke();

      ctx.lineWidth = 2.5; ctx.shadowColor = 'rgba(0,229,255,.65)'; ctx.shadowBlur = 8; ctx.strokeStyle = '#75f6ff';
      ctx.beginPath();

      for(let x=0; x<w; x++){
        const t = (x / w) * cycles * Math.PI * 2; let y = 0;
        switch(type){
          case 'sine': y = Math.sin(t); break;
          case 'square': y = Math.sin(t) >= 0 ? 1 : -1; break;
          case 'sawtooth': y = 2 * ( (t % (2*Math.PI)) / (2*Math.PI)) - 1; break;
          case 'triangle': const saw = 2 * ( (t % (2*Math.PI)) / (2*Math.PI)) - 1; y = Math.abs(saw) * 2 - 1; break;
        }
        const py = cx - y * amp; (x===0) ? ctx.moveTo(x, py) : ctx.lineTo(x, py);
      }
      ctx.stroke();
    }

    function drawAll(){
      drawWave('sineCanvas', 'sine');
      drawWave('squareCanvas', 'square');
      drawWave('sawCanvas', 'sawtooth');
      drawWave('triangleCanvas', 'triangle');

      drawWave('miniSine', 'sine', 2);
      drawWave('miniSquare', 'square', 2);
      drawWave('miniSaw', 'sawtooth', 2);
      drawWave('miniTriangle', 'triangle', 2);
    }

    // Init
    window.addEventListener('DOMContentLoaded', () => { drawAll(); setStatus('Audio: idle'); });
    window.addEventListener('resize', () => { drawAll(); });
  </script>
</body>
</html>
